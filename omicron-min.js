(function(a){function j(){}function k(){return this}function l(a,b){var c=l.fn[a];return c&&b[a]===c?c.apply(b,i.call(arguments,2)):e}function m(a){return a==null?String(a):m.map[f.call(a)]||"object"}function n(a){return m(a)==="boolean"}function o(a){return m(a)==="string"}function p(a){return!isNaN(parseFloat(a))&&isFinite(a)}function q(a){return m(a)==="array"}function r(a){return m(a)==="function"}function s(c){var d;if(!c||m(c)!=="object"||c.nodeType||c===b||c.constructor&&!g.call(c,"constructor")&&!g.call(c.constructor.prototype,"isPrototypeOf"))return!1;for(d in c);return d===a||g.call(c,d)}function t(a,b){var c;if(q(a)&&a.length)return!1;for(c in a)if(b||g.call(a,c))return!1;return!0}function u(a,b){return a===b||t(A(a,b||{}))}function v(b,c){if(!b)return;var d,e,f=b.length;if(f===a||r(b)){for(d in b)if(c.call(b[d],d,b[d],b)===!1)break}else for(e=0,f=b.length;e<f;)if(c.call(b[e],e,b[e++],b)===!1)break;return b}function w(b,c,d){var f,g,h,i;if(b==null)return;if((f=l("forEach",b,c,d))!==e)return f;if((g=b.length)===a||r(b)){for(h in b)if(c.call(d||b[h],b[h],h,b)===!1)break}else for(i=0,g=b.length;i<g;)if(c.call(d||b[i],b[i],i++,b)===!1)break;return b}function x(){var b,c,d,f,h,i,j,k,l,n,o,p,u,v,w,y;b=0,c=arguments.length,d=m(arguments[0]),d==="boolean"?(h="deep",f={deep:h},b+=1):d==="string"?(h=arguments[b],f=B(h),b+=1):f=e,i=arguments[b]||{},b+=1,typeof i=="object"||r(i)||(i={}),j=q(i),f.delta&&c-1>b&&(k=[]);for(;b<c;b++){f.delta&&(l=j?[]:{}),k&&k.push(l),u=arguments[b];if(u==null)continue;for(n in u)if(!f.own||g.call(u,n)){o=u[n];if(o===i)continue;o===e&&!f.all?(l&&(l[n]=i[n]),f.immutable||delete i[n]):f.deep&&o&&(s(o)||(p=q(o)))?(v=i[n],p?(p=!1,w=v&&q(v)?v:[]):w=v&&(r(v)||typeof v=="object")?v:{},y=x(h,w,o),l&&(g.call(i,n)?y&&!t(y)&&(l[n]=y):l[n]=e),f.immutable||(i[n]=w)):i[n]!==o&&(o!==a||f.all)&&(l&&(l[n]=g.call(i,n)?i[n]:e),f.immutable||(i[n]=o))}if(f.absolute&&(f.delta||!f.immutable))for(n in i)g.call(i,n)&&((f.own?g.call(u,n):n in u)||(l&&(l[n]=i[n]),f.immutable||delete i[n]))}return k||l||i}function y(){return x.apply(c,["deep all",q(arguments[0])?[]:{}].concat(i.call(arguments)))}function z(){return x.apply(c,["deep delta"].concat(i.call(arguments)))}function A(){return x.apply(c,["deep delta immutable absolute"].concat(i.call(arguments)))}function B(b,c,e){var f,h,i,j,k;typeof b=="string"?(f=arguments.length===1,e=c,c=b,b={}):(f=typeof c=="string"&&arguments.length===2,c===a&&(c=b,b={})),typeof c=="string"&&(h=c,(c={})[h]=e);for(h in c)if(g.call(c,h)){i=h.split(d.whitespace);if(f)for(j=0,k=i.length;j<k;j++)e=i[j],b[e]=e;else{e=c[h];for(j=0,k=i.length;j<k;j++)b[i[j]]=e}}return b}function C(a){q(a)||(a=[a]);var b=0,c=a.length,d,e=[];while(b<c)d=a[b++],q(d)?e=e.concat(C(d)):e.push(d);return e}function D(a){var b,c=[];if(!s(a)&&!r(a))throw new TypeError;for(b in a)g.call(a,b)&&c.push(b);return c}function E(a){var b,c,d={};if(q(a))for(b=0,c=a.length;b<c;b++)d[""+a[b]]=b;else for(b in a)g.call(a,b)&&(d[""+a[b]]=b);return d}function F(a,b){var c,e,f,g,h;for(c in b)if(c in a){f=b[c].split(d.whitespace);for(g=0,h=f.length;g<h;g++)a[f[g]]=a[c]}return a}function G(a){return function(){return a}}function H(b,c,d){var e=b,f=0,h=(c=c.split(d||".")).length,i;while(f<h&&e!=null)if(g.call(e,i=c[f++]))e=e[i];else return a;return e}function I(a){var b,c=function(){};return c.prototype=a,b=new c,b.__proto__=a,b.constructor=a.constructor,b}function J(a,b,c,d){return r(b)?(x(a,b).prototype=I(b.prototype)).constructor=a:(d=c,c=b),c&&x(a.prototype,c),d&&x(a,d),a}function K(b,c,e){return v(e,function(e,f){v(e.split(d.whitespace),function(d,e){b[e]=c[e].apply(a,f)})}),b}function L(a){return a.__proto__||a.constructor.prototype}function M(a){return a.valueOf=a}function N(a){return a.toString=a}var b=this,c={VERSION:"0.1.6",env:{server:typeof module!="undefined"&&typeof require!="undefined"&&!!module.exports,client:typeof window!="undefined"&&window===b,debug:!1}},d=c.regexp={whitespace:/\s+/},e=c.NIL=function(){function a(){}return new a}(),f=c.toString=Object.prototype.toString,g=c.hasOwn=Object.prototype.hasOwnProperty,h=c.trim=String.prototype.trim?function(a){return a==null?"":String.prototype.trim.call(a)}:function(a){return a==null?"":a.toString().replace(/^\s+/,"").replace(/\s+$/,"")},i=c.slice=Array.prototype.slice;c.noConflict=function(){var a=b.O;return function(){return b.O=a,this}}(),c.noop=j,c.getThis=k,l.fn={forEach:Array.prototype.forEach},m.map={},v("Array Boolean Date Function Number Object RegExp String".split(" "),function(a,b){m.map["[object "+b+"]"]=b.toLowerCase()}),c.type=m,c.isBoolean=n,c.isString=o,c.isNumber=p,c.isArray=q,c.isFunction=r,c.isPlainObject=s,c.isEmpty=t,c.isEqual=u,c.each=v,c.forEach=w,c.edit=c.extend=x,c.clone=y,c.delta=z,c.diff=A,c.assign=B,c.flatten=C,c.keys=D=r(Object.keys)?Object.keys:D,c.invert=E,c.alias=F,c.thunk=G,c.lookup=H,c.create=r(Object.create)?I=Object.create:I,c.inherit=J,c.privilege=K,c.getPrototypeOf=r(Object.getPrototypeOf)?L=Object.getPrototypeOf:L,c.valueFunction=M,c.stringFunction=N,c.env.server&&(module.exports=c),c.env.client&&(b.O=c)})();